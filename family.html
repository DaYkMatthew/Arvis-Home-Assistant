<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <title>ARVIS - Family Room</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    * { user-select: none; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
    body { margin: 0; background: #000; color: #fff; overflow-x: hidden; }
    .glass { background: rgba(17, 25, 40, 0.75); backdrop-filter: blur(16px) saturate(180%); border: 1px solid rgba(255, 255, 255, 0.125); }
    @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .slide-in { animation: slideIn 0.4s ease-out; }
    .notification-bar { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; background: linear-gradient(90deg, #f59e0b, #d97706); color: #000; padding: 12px; text-align: center; font-weight: 600; transform: translateY(-100%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
    .notification-bar.show { transform: translateY(0); }
    .hover-lift:hover { transform: translateY(-2px); box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5); }
    button:active { transform: scale(0.98); }
    .skeleton { background: linear-gradient(90deg, #1f2937 25%, #374151 50%, #1f2937 75%); background-size: 200% 100%; animation: loading 1.5s infinite; }
    @keyframes loading { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
  </style>
</head>
<body>
  <div id="notification-bar" class="notification-bar"></div>
  <div class="min-h-screen p-4 slide-in">
    <div class="flex justify-between items-center mb-6 pt-4">
      <div><h1 class="text-3xl font-light text-white">ARVIS</h1><p class="text-gray-400 text-sm">Family Room</p></div>
      <div class="flex gap-3">
        <button onclick="openNotifications()" class="relative p-3 rounded-full glass hover-lift"><svg class="w-6 h-6 text-gray-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 01-3.46 0"/></svg><span id="notif-badge" class="hidden absolute top-1 right-1 w-3 h-3 bg-yellow-500 rounded-full animate-pulse"></span></button>
        <button onclick="logout()" class="p-3 rounded-full glass hover-lift"><svg class="w-6 h-6 text-gray-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0110 0v4"/></svg></button>
      </div>
    </div>

    <div class="mb-4 p-5 rounded-2xl glass hover-lift">
      <div id="time" class="text-5xl font-light mb-2"><div class="skeleton h-14 w-32 rounded"></div></div>
      <div id="date" class="text-xl text-gray-400 mb-3"><div class="skeleton h-6 w-48 rounded"></div></div>
      <div id="weather" class="text-2xl text-blue-400 mb-3"><div class="skeleton h-8 w-40 rounded"></div></div>
      <div class="flex gap-4 text-sm flex-wrap">
        <div class="flex items-center gap-2"><div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div><span class="text-gray-400">Online</span></div>
        <div class="text-gray-400" id="local-ip"><div class="skeleton h-4 w-32 rounded inline-block"></div></div>
        <div class="text-gray-400">WiFi: Connected</div>
      </div>
    </div>

    <div class="mb-4 p-4 rounded-2xl glass hover-lift">
      <p id="quote" class="text-base text-gray-300 italic mb-2"><div class="skeleton h-4 w-full rounded mb-2"></div><div class="skeleton h-4 w-3/4 rounded"></div></p>
      <p id="author" class="text-sm text-gray-500">â€”</p>
    </div>

    <div class="mb-4 p-4 rounded-2xl glass hover-lift">
      <h2 class="text-lg font-light mb-3">Countdowns</h2>
      <div id="weekend-countdown" class="mb-3 p-3 rounded-xl glass"><div class="flex justify-between items-center"><span>Weekend</span><span class="text-green-400 font-mono" id="weekend-time">--</span></div></div>
      <div id="custom-countdowns"></div>
      <button onclick="openAddCountdown()" class="w-full p-3 rounded-xl glass text-gray-400 hover-lift mt-2">+ Add Countdown</button>
    </div>

    <!-- TV Power Control -->
    <div class="mb-4 p-4 rounded-2xl glass hover-lift">
      <h2 class="text-lg font-light mb-3">TV Control</h2>
      <button onclick="toggleTV()" class="w-full p-5 rounded-xl glass hover-lift" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.2), rgba(16, 185, 129, 0.2));">
        <svg class="w-10 h-10 mx-auto mb-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="color: #10b981;">
          <path d="M18.36 6.64a9 9 0 11-12.73 0"/>
          <line x1="12" y1="2" x2="12" y2="12"/>
        </svg>
        <div class="text-lg">Turn TV <span id="tv-status">ON</span></div>
      </button>
    </div>

    <!-- Lights -->
    <div class="mb-4 p-4 rounded-2xl glass hover-lift">
      <h2 class="text-lg font-light mb-3">Lights</h2>
      <div class="flex justify-between items-center p-3 rounded-xl glass">
        <span>Family Room Light</span>
        <label class="relative inline-flex items-center cursor-pointer">
          <input type="checkbox" class="sr-only peer" onchange="toggleLight()">
          <div class="w-11 h-6 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-yellow-500"></div>
        </label>
      </div>
    </div>

    <!-- Essential Apps Only -->
    <div class="grid grid-cols-2 gap-4 mb-4">
      <button onclick="openShout()" class="p-5 rounded-2xl glass hover-lift text-left" style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(217, 119, 6, 0.2));"><div class="text-3xl mb-2">ðŸ“¢</div><div class="text-lg">Shout</div><div class="text-sm text-gray-400">Send message</div></button>
      <button onclick="window.open('https://open.spotify.com')" class="p-5 rounded-2xl glass hover-lift text-left" style="background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(5, 150, 105, 0.2));"><div class="text-3xl mb-2">ðŸŽµ</div><div class="text-lg">Spotify</div><div class="text-sm text-gray-400">Play music</div></button>
    </div>
  </div>

  <div id="shout-modal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50" onclick="if(event.target === this) closeShout()">
    <div class="glass rounded-2xl p-6 w-full max-w-md slide-in"><h2 class="text-2xl mb-4">Send Shout</h2><textarea id="shout-message" placeholder="Your message..." class="w-full p-3 rounded-xl glass text-white mb-4 h-24 focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea><div class="mb-4"><p class="text-sm text-gray-400 mb-2">Send to:</p><div class="flex gap-2 flex-wrap"><label class="flex items-center gap-2 p-2 rounded-lg glass cursor-pointer hover-lift"><input type="checkbox" value="0920" class="shout-recipient"><span>Matthew</span></label><label class="flex items-center gap-2 p-2 rounded-lg glass cursor-pointer hover-lift"><input type="checkbox" value="0304" class="shout-recipient"><span>Bryce</span></label><label class="flex items-center gap-2 p-2 rounded-lg glass cursor-pointer hover-lift"><input type="checkbox" id="shout-all"><span>ALL</span></label></div></div><div class="flex gap-2"><button onclick="sendShout()" class="flex-1 p-3 rounded-xl bg-gradient-to-r from-blue-600 to-cyan-600 hover-lift">Send</button><button onclick="closeShout()" class="flex-1 p-3 rounded-xl glass hover-lift">Cancel</button></div></div>
  </div>

  <div id="add-countdown-modal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50" onclick="if(event.target === this) closeAddCountdown()">
    <div class="glass rounded-2xl p-6 w-full max-w-md slide-in"><h2 class="text-2xl mb-4">Add Countdown</h2><input id="countdown-name" type="text" placeholder="Event name" class="w-full p-3 rounded-xl glass text-white mb-3 focus:outline-none focus:ring-2 focus:ring-blue-500"><input id="countdown-date" type="date" class="w-full p-3 rounded-xl glass text-white mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500"><div class="flex gap-2"><button onclick="saveCountdown()" class="flex-1 p-3 rounded-xl bg-gradient-to-r from-green-600 to-emerald-600 hover-lift">Save</button><button onclick="closeAddCountdown()" class="flex-1 p-3 rounded-xl glass hover-lift">Cancel</button></div></div>
  </div>

  <div id="notif-modal" class="hidden fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 z-50" onclick="if(event.target === this) closeNotifications()">
    <div class="glass rounded-2xl p-6 w-full max-w-md max-h-[80vh] overflow-y-auto slide-in"><div class="flex justify-between items-center mb-4"><h2 class="text-2xl">Notifications</h2><button onclick="closeNotifications()" class="text-gray-400 hover:text-white">âœ•</button></div><div id="notif-list"></div></div>
  </div>

  <script>
    let inactivityTimer;
    function resetInactivityTimer() { clearTimeout(inactivityTimer); inactivityTimer = setTimeout(() => logout(), 5 * 60 * 1000); }
    document.addEventListener('click', resetInactivityTimer); document.addEventListener('touchstart', resetInactivityTimer); resetInactivityTimer();

    function updateTime() { const now = new Date(); document.getElementById('time').innerHTML = now.toLocaleTimeString('en-US', {hour: 'numeric', minute: '2-digit', hour12: true}); document.getElementById('date').innerHTML = now.toLocaleDateString('en-US', {weekday: 'long', month: 'long', day: 'numeric'}); }
    setInterval(updateTime, 1000); updateTime();

    function getLocalIP() { fetch('https://api.ipify.org?format=json').then(res => res.json()).then(data => { document.getElementById('local-ip').innerHTML = `IP: ${data.ip}`; }).catch(() => { document.getElementById('local-ip').innerHTML = 'IP: Unavailable'; }); }
    getLocalIP();

    async function fetchWeather() { try { let lat = 37.3382, lon = -121.8863; if ('geolocation' in navigator) { const pos = await new Promise((resolve, reject) => { navigator.geolocation.getCurrentPosition(resolve, reject); }); lat = pos.coords.latitude; lon = pos.coords.longitude; } const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&temperature_unit=fahrenheit`); const data = await res.json(); const temp = Math.round(data.current_weather.temperature); const condition = data.current_weather.weathercode === 0 ? 'Clear' : data.current_weather.weathercode <= 3 ? 'Cloudy' : 'Rainy'; document.getElementById('weather').innerHTML = `${temp}Â°F - ${condition}`; } catch { document.getElementById('weather').innerHTML = 'Weather unavailable'; } }
    fetchWeather();

    async function fetchQuote() { try { const res = await fetch('https://zenquotes.io/api/random'); const data = await res.json(); document.getElementById('quote').innerHTML = `"${data[0].q}"`; document.getElementById('author').innerHTML = `â€” ${data[0].a}`; } catch { document.getElementById('quote').innerHTML = '"Enjoy the moment."'; document.getElementById('author').innerHTML = 'â€” ARVIS'; } }
    fetchQuote();

    function updateWeekendCountdown() { const now = new Date(); const day = now.getDay(); const hour = now.getHours(); const minute = now.getMinutes(); let target; if (day < 5 || (day === 5 && (hour < 15 || (hour === 15 && minute < 45)))) { target = new Date(now); target.setDate(now.getDate() + ((5 - day + 7) % 7)); target.setHours(15, 45, 0, 0); if (day === 5 && hour >= 15 && minute >= 45) target.setDate(target.getDate() + 7); } else { target = new Date(now); target.setDate(now.getDate() + ((8 - day) % 7)); target.setHours(0, 0, 0, 0); } const diff = target - now; const days = Math.floor(diff / (1000 * 60 * 60 * 24)); const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)); const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60)); let text = ''; if (days > 0) text += `${days}d `; text += `${hours}h ${minutes}m`; document.getElementById('weekend-time').textContent = text; }
    setInterval(updateWeekendCountdown, 1000); updateWeekendCountdown();

    function toggleTV() { alert('TV Power toggled!\n\nConnect to Hubspace smart plug to make this work.'); }
    function toggleLight() { alert('Family Room Light toggled!\n\nConnect to smart home system to make this work.'); }

    function openShout() { document.getElementById('shout-modal').classList.remove('hidden'); }
    function closeShout() { document.getElementById('shout-modal').classList.add('hidden'); document.getElementById('shout-message').value = ''; }
    function sendShout() { const message = document.getElementById('shout-message').value.trim(); if (!message) return alert('Please enter a message'); const recipients = []; const checkboxes = document.querySelectorAll('.shout-recipient:checked'); const all = document.getElementById('shout-all').checked; if (all) { recipients.push('0920', '0304'); } else { checkboxes.forEach(cb => recipients.push(cb.value)); } if (recipients.length === 0) return alert('Please select recipients'); const shout = { from: '6288', fromName: 'Family Room', message: message, to: recipients, timestamp: Date.now(), read: false }; const shouts = JSON.parse(localStorage.getItem('arvis_shouts') || '[]'); shouts.push(shout); localStorage.setItem('arvis_shouts', JSON.stringify(shouts)); alert('Shout sent!'); closeShout(); }

    function checkNotifications() { const shouts = JSON.parse(localStorage.getItem('arvis_shouts') || '[]'); const myShouts = shouts.filter(s => s.to.includes('6288') && !s.read); if (myShouts.length > 0) { document.getElementById('notif-badge').classList.remove('hidden'); const bar = document.getElementById('notification-bar'); bar.textContent = `${myShouts.length} new message${myShouts.length > 1 ? 's' : ''}`; bar.classList.add('show'); } else { document.getElementById('notif-badge').classList.add('hidden'); document.getElementById('notification-bar').classList.remove('show'); } }
    setInterval(checkNotifications, 2000); checkNotifications();

    function openNotifications() { const shouts = JSON.parse(localStorage.getItem('arvis_shouts') || '[]'); let myShouts = shouts.filter(s => s.to.includes('6288')); shouts.forEach(s => { if (s.to.includes('6288')) s.read = true; }); localStorage.setItem('arvis_shouts', JSON.stringify(shouts)); const list = document.getElementById('notif-list'); if (myShouts.length === 0) { list.innerHTML = '<p class="text-gray-500">No notifications</p>'; } else { list.innerHTML = myShouts.reverse().map(s => `<div class="p-3 rounded-xl glass mb-2 hover-lift"><div class="flex justify-between mb-1"><span class="font-medium">${s.fromName}</span><span class="text-sm text-gray-500">${new Date(s.timestamp).toLocaleTimeString()}</span></div><p class="text-gray-300">${s.message}</p></div>`).join(''); } document.getElementById('notif-modal').classList.remove('hidden'); setTimeout(() => { document.getElementById('notif-badge').classList.add('hidden'); document.getElementById('notification-bar').classList.remove('show'); }, 300); }
    function closeNotifications() { document.getElementById('notif-modal').classList.add('hidden'); }

    function openAddCountdown() { document.getElementById('add-countdown-modal').classList.remove('hidden'); }
    function closeAddCountdown() { document.getElementById('add-countdown-modal').classList.add('hidden'); document.getElementById('countdown-name').value = ''; document.getElementById('countdown-date').value = ''; }
    function saveCountdown() { const name = document.getElementById('countdown-name').value.trim(); const date = document.getElementById('countdown-date').value; if (!name || !date) return alert('Please fill all fields'); const countdowns = JSON.parse(localStorage.getItem('arvis_countdowns_6288') || '[]'); countdowns.push({id: Date.now(), name, date}); localStorage.setItem('arvis_countdowns_6288', JSON.stringify(countdowns)); loadCustomCountdowns(); closeAddCountdown(); }
    function loadCustomCountdowns() { const countdowns = JSON.parse(localStorage.getItem('arvis_countdowns_6288') || '[]'); const container = document.getElementById('custom-countdowns'); container.innerHTML = countdowns.map(c => { const target = new Date(c.date); const now = new Date(); const diff = target - now; const days = Math.floor(diff / (1000 * 60 * 60 * 24)); const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)); return `<div class="mb-2 p-3 rounded-xl glass flex justify-between items-center hover-lift"><span>${c.name}</span><div class="flex items-center gap-2"><span class="text-green-400 font-mono">${days}d ${hours}h</span><button onclick="deleteCountdown(${c.id})" class="text-red-400 hover:text-red-300">âœ•</button></div></div>`; }).join(''); }
    function deleteCountdown(id) { const countdowns = JSON.parse(localStorage.getItem('arvis_countdowns_6288') || '[]'); localStorage.setItem('arvis_countdowns_6288', JSON.stringify(countdowns.filter(c => c.id !== id))); loadCustomCountdowns(); }
    loadCustomCountdowns(); setInterval(loadCustomCountdowns, 60000);

    function logout() { sessionStorage.clear(); window.location.href = 'index.html'; }
  </script>
</body>
</html>
